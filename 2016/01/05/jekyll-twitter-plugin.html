<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Jekyll Twitter Plugin</title>
  <meta name="description" content="One of the downsides to using Octopress over vanilla Jekyll when deploying a blog like this to GitHub Pages is that you have to explicitly generate your stat...">

  <!-- Pinterest website verify -->
  <meta name="p:domain_verify" content="5cbb342a8c797d163b5acd5baf03971f"/>

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://phatbl.at/2016/01/05/jekyll-twitter-plugin.html">
  <link rel="alternate" type="application/rss+xml" title="phatblat's reflog" href="https://phatbl.at/feed.xml" />
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">phatblat's reflog</a>
  <!--
    <a id="go-back-home" href="/"><img src="https://s.gravatar.com/avatar/153573b9010e611f9ef7561cad74febc?s=80" ></a>
  -->


    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewbox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Jekyll Twitter Plugin</h1>
    <p class="post-meta">Jan 5, 2016</p>
  </header>

  <article class="post-content">
    <p>One of the downsides to using Octopress over vanilla Jekyll when deploying a blog like this to GitHub Pages is that you have to explicitly generate your static site files. This is because Octopress deploys only the static site to GHP. A simple Jekyll site can actually push the markdown source and config files directly to GHP and let them generate the static site. This downside is more pronounced for me as I’m doing the vast majority of work on this blog from my iPad Pro, where I don’t have a ruby environment to run the octopress and jekyll commands.</p>

<p>However, there is a big upside to this arrangement: you’re not limitated to the few <a href="https://help.github.com/articles/using-jekyll-plugins-with-github-pages/">Jekyll plugins</a> that GHP supports! GHP is simply hosting the generated site and I can run anything I want on my Mac to do that generation.</p>

<p>So, let’s check out some nifty plugins, shall we?</p>

<h1 id="embedded-tweets">Embedded Tweets</h1>

<p>In the spirit of markup free writing, I’d like to be able to reference a tweet by URL and have the content and formatting applied automatically. Luckily, there are plugins for this.</p>

<h2 id="jekyll-tweet-tag">jekyll-tweet-tag</h2>

<p>The first plugin that I found when looking for this functionality is the obsolete <a href="https://github.com/scottwb/jekyll-tweet-tag">jekyll-tweet-tag</a>. Save yourself some time and don’t bother installing this since it doesn’t work with the current Twitter API.</p>

<p>Syntax:</p>

<!-- https://stackoverflow.com/a/5866429/39207 -->
<div class="language-liquid highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>{% tweet https://twitter.com/DEVOPS_BORAT/statuses/159849628819402752 %}
</pre></div>
</div>
</div>

<h2 id="jekyll-twitter-plugin">jekyll-twitter-plugin</h2>

<p>Based on the tweet-tag plugin, the <a href="https://github.com/rob-murray/jekyll-twitter-plugin">jekyll-twitter-plugin</a> provides the same functionality but has been updated to work with the newer Twitter API preconditions (authentication keys) and also is a proper ruby gem for easier installation and updates.</p>

<p>The syntax is very similar:</p>

<div class="language-liquid highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>{% twitter https://twitter.com/DEVOPS_BORAT/statuses/159849628819402752 %}
</pre></div>
</div>
</div>

<div class="jekyll-twitter-plugin">
<blockquote class="twitter-tweet">
<p lang="en" dir="ltr">Best analogy I find so far for explain concept of ScrumMaster to new devops is Tooth Fairy.</p>— DevOps Borat (<a href="https://twitter.com/DEVOPS_BORAT" class="user-mention">@DEVOPS_BORAT</a>) <a href="https://twitter.com/DEVOPS_BORAT/status/159849628819402752?ref_src=twsrc%5Etfw">January 19, 2012</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>

<h3 id="ad-blockers">Ad Blockers</h3>

<p>Note: if you’re blocking the “Twitter Button” tracker with a browser plugin like Ghostery, you won’t see the <a href="https://developer.twitter.com/en/docs/twitter-for-websites/cards/guides/getting-started">Twitter Card</a> version of these embedded tweets with images and they will instead fall back to a text-only version.</p>

<p><img src="/images/ghostery-twitter-button.png" alt="Ghostery Safari plugin showing Twitter tracker blocked"></p>

<h3 id="align--width">align &amp; width</h3>

<p>There are a few formatting options, such as <code>align</code> and <code>width</code>:</p>

<div class="language-liquid highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>{% twitter https://twitter.com/DEVOPS_BORAT/statuses/159849628819402752 align='center' width='220' %}
</pre></div>
</div>
</div>

<div class="jekyll-twitter-plugin">
<blockquote class="twitter-tweet" align="center">
<p lang="en" dir="ltr">Best analogy I find so far for explain concept of ScrumMaster to new devops is Tooth Fairy.</p>— DevOps Borat (<a href="https://twitter.com/DEVOPS_BORAT" class="user-mention">@DEVOPS_BORAT</a>) <a href="https://twitter.com/DEVOPS_BORAT/status/159849628819402752?ref_src=twsrc%5Etfw">January 19, 2012</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>

<p>The <code>width</code> parameter must be between 220 and 550 inclusive and seems to have no effect on the text-only rendering of the tweet.</p>

<h3 id="hide_media">hide_media</h3>

<p>This plugin will pass along any extra parameters like <code>hide_media</code> to the <a href="https://dev.twitter.com/rest/reference/get/statuses/oembed">oembed API</a> for further customization.</p>

<div class="language-liquid highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>{% twitter https://twitter.com/DEVOPS_BORAT/statuses/159849628819402752 hide_media='true' %}
</pre></div>
</div>
</div>

<div class="jekyll-twitter-plugin">
<blockquote class="twitter-tweet" data-cards="hidden">
<p lang="en" dir="ltr">Best analogy I find so far for explain concept of ScrumMaster to new devops is Tooth Fairy.</p>— DevOps Borat (<a href="https://twitter.com/DEVOPS_BORAT" class="user-mention">@DEVOPS_BORAT</a>) <a href="https://twitter.com/DEVOPS_BORAT/status/159849628819402752?ref_src=twsrc%5Etfw">January 19, 2012</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>

<p>Text rendering of the tweet is unaffected by <code>hide_media</code> because it only includes a link by default.</p>

<h2 id="configuration">Configuration</h2>

<blockquote>
  <p>Note: Since version 2.0.0 these Authentication &amp; API keys are no longer needed.</p>
</blockquote>

<p>There are two options for configuring this Twitter plugin with your authentication keys:</p>

<ol>
  <li>Add them to <code>_config.yml</code>
</li>
  <li>Define them as environment variables</li>
</ol>

<p>Since I’m tracking my <code>_config.yml</code> in git, shared publicly on GitHub, I’m opting for #2.</p>

<p>The challenge with environment variables is making sure they are defined whenever you need to run the command that depends on them. A simple solution is to add them to your <code>.bash_profile</code> or <code>.zshrc</code>, but since I’m <em>also</em> <a href="https://github.com/phatblat/dotfiles/blob/main/.zshrc">storing that on GitHub</a>, I’m going to look for another option.</p>

<h2 id="env-file">.env File</h2>

<p>Here is a very simple untracked file based solution. I created an <code>.env</code> file containing each environment variable on a separate line like so:</p>

<div class="language-bash highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>TWITTER_CONSUMER_KEY=...
TWITTER_CONSUMER_SECRET=...
TWITTER_ACCESS_TOKEN=...
TWITTER_ACCESS_TOKEN_SECRET=...
</pre></div>
</div>
</div>

<p>The values in this file are then loaded into the environment for the Jekyll process on the fly using the <code>env</code> command.</p>

<div class="language-bash highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>env $(cat .env | xargs) bundle exec jekyll serve
</pre></div>
</div>
</div>

<p>This is wrapped up neatly in a <a href="https://github.com/phatblat/dotfiles/blob/main/.config/fish/functions/serve.fish#L10"><code>serve</code></a> alias so I don’t have to type (or remember) all that each time.</p>

<p>One caveat is that this command now generates an error if there is not an <code>.env</code> file in the current directory. I like that because I’m frequently in the wrong directory when I type <code>serve</code> and Jekyll is happy to create <code>_site</code> folders wherever I happen to be before blowing up in my face.</p>

<h2 id="export">Export</h2>

<p>Note that the above environment variables can be loaded into the shell using the builtin <code>export</code> command instead of <code>env</code>. That is fine for testing, but leaves them defined in the environment for any other process to read.</p>

<div class="language-bash highlighter-coderay">
<div class="CodeRay">
  <div class="code"><pre>echo $TWITTER_CONSUMER_KEY
</pre></div>
</div>
</div>

<p>I tend to forget about this sort of thing (it works, <img class="emoji" title=":shipit:" alt=":shipit:" src="https://github.githubassets.com/images/icons/emoji/shipit.png" height="20" width="20">!) and would rather limit the exposure of sensitive values to the exact scope that they are needed.</p>

<h1 id="references">References</h1>

<ul>
  <li><a href="https://github.com/rob-murray/jekyll-twitter-plugin">https://github.com/rob-murray/jekyll-twitter-plugin</a></li>
  <li><a href="https://dev.twitter.com/rest/reference/get/statuses/oembed">https://dev.twitter.com/rest/reference/get/statuses/oembed</a></li>
  <li><a href="http://stackoverflow.com/questions/19331497/set-environment-variables-from-file">http://stackoverflow.com/questions/19331497/set-environment-variables-from-file</a></li>
</ul>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">phatblat's reflog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>phatblat's reflog</li>
          <li><a href="mailto:"></a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/phatblat">
              <span class="icon  icon--github">
                <svg viewbox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"></path>
                </svg>
              </span>

              <span class="username">phatblat</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/phatblat">
              <span class="icon  icon--twitter">
                <svg viewbox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"></path>
                </svg>
              </span>

              <span class="username">phatblat</span>
            </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">a few SHAs from a journey through code</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
